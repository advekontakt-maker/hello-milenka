<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>KaraluszekMilenkowy</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <button class="btn" id="loveBtn">Kliknij Å¼eby odkryÄ‡ niespodziankÄ™</button>
  </div>

  <script>
    const btn = document.getElementById('loveBtn');
    const container = document.querySelector('.container');

    const heartEmojis = ['â¤', 'ðŸ’—', 'ðŸ’–', 'ðŸ’ž', 'ðŸ’•', 'â£ï¸'];

    btn.addEventListener('click', (e) => {
      // get button bounds to spawn hearts all over it
      const btnRect = btn.getBoundingClientRect();
      const btnWidth = btnRect.width;
      const btnHeight = btnRect.height;
      const btnCenterX = btnRect.left + btnWidth / 2;
      const btnCenterY = btnRect.top + btnHeight / 2;

      // create a burst of hearts and occasional sparkles
      for (let i = 0; i < 15; i++) {
        // random position within and around the button area
        const randomX = btnRect.left + Math.random() * btnWidth;
        const randomY = btnRect.top + Math.random() * btnHeight;
        createHeart(randomX, randomY);
        if (Math.random() < 0.4) createSpark(btnCenterX, btnCenterY);
      }

      // after animation, create a new button
      setTimeout(() => {
        createNewButton();
      }, 600);
    });

    function createHeart(x, y) {
      const heart = document.createElement('span');
      heart.className = 'heart';
      heart.innerText = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];

      const rect = container.getBoundingClientRect();
      const left = x - rect.left - 12;
      const top = y - rect.top - 12;

      heart.style.left = left + 'px';
      heart.style.top = top + 'px';
      heart.style.pointerEvents = 'none'; // prevent blocking clicks

      const size = Math.floor(Math.random() * 22) + 16;
      heart.style.fontSize = size + 'px';
      heart.style.opacity = (Math.random() * 0.4 + 0.6).toString();

      const dx = Math.floor((Math.random() - 0.5) * 220);
      const rot = Math.floor((Math.random() - 0.5) * 720);
      const dur = (1.2 + Math.random() * 1.4).toFixed(2) + 's';

      heart.style.setProperty('--dx', dx + 'px');
      heart.style.setProperty('--rot', rot + 'deg');
      heart.style.setProperty('--dur', dur);
      heart.style.animationDuration = dur;

      container.appendChild(heart);

      // ensure heart is removed after animation completes
      const animationDuration = parseFloat(dur) * 1000;
      setTimeout(() => {
        if (heart.parentNode) {
          heart.remove();
        }
      }, animationDuration + 200);
    }

    function createSpark(x, y) {
      const spark = document.createElement('span');
      spark.className = 'spark';
      const rect = container.getBoundingClientRect();
      const left = x - rect.left - 4 + (Math.random() - 0.5) * 24;
      const top = y - rect.top - 4 + (Math.random() - 0.5) * 12;
      spark.style.left = left + 'px';
      spark.style.top = top + 'px';
      container.appendChild(spark);
      setTimeout(() => spark.remove(), 1000);
    }

    function createNewButton() {
      const newBtn = document.createElement('button');
      newBtn.className = 'btn btn-appear';
      newBtn.innerText = 'SprÃ³buj jeszcze raz';
      
      // replace the old button with new one in the DOM
      btn.parentNode.replaceChild(newBtn, btn);
      
      // create burst particles around new button
      const newBtnRect = newBtn.getBoundingClientRect();
      const centerX = newBtnRect.left + newBtnRect.width / 2;
      const centerY = newBtnRect.top + newBtnRect.height / 2;
      
      for (let i = 0; i < 8; i++) {
        const angle = (i / 8) * Math.PI * 2;
        const distance = 80;
        const x = centerX + Math.cos(angle) * distance;
        const y = centerY + Math.sin(angle) * distance;
        createBurstParticle(x, y, angle);
      }
      
      // attach click listener to new button
      newBtn.addEventListener('click', (e) => {
        // get button bounds to spawn hearts all over it
        const btnRect = newBtn.getBoundingClientRect();
        const btnWidth = btnRect.width;
        const btnHeight = btnRect.height;
        const btnCenterX = btnRect.left + btnWidth / 2;
        const btnCenterY = btnRect.top + btnHeight / 2;

        // create a burst of hearts and occasional sparkles
        for (let i = 0; i < 15; i++) {
          const randomX = btnRect.left + Math.random() * btnWidth;
          const randomY = btnRect.top + Math.random() * btnHeight;
          createHeart(randomX, randomY);
          if (Math.random() < 0.4) createSpark(btnCenterX, btnCenterY);
        }

        // create another new button
        setTimeout(() => {
          createNewButton();
        }, 600);
      });
    }

    function createBurstParticle(x, y, angle) {
      const particle = document.createElement('span');
      particle.className = 'burst-particle';
      particle.innerHTML = ['âœ¨', 'ðŸ’«', 'â­'][Math.floor(Math.random() * 3)];
      
      const rect = container.getBoundingClientRect();
      particle.style.left = (x - rect.left) + 'px';
      particle.style.top = (y - rect.top) + 'px';
      particle.style.position = 'absolute';
      particle.style.fontSize = '20px';
      particle.style.pointerEvents = 'none';
      particle.style.willChange = 'transform, opacity';
      
      // calculate translation
      const distance = 120;
      const tx = Math.cos(angle) * distance;
      const ty = Math.sin(angle) * distance;
      
      particle.style.setProperty('--tx', tx + 'px');
      particle.style.setProperty('--ty', ty + 'px');
      particle.style.animation = `burstFloat 0.8s ease-out forwards`;
      
      container.appendChild(particle);
      setTimeout(() => {
        if (particle.parentNode) {
          particle.remove();
        }
      }, 900);
    }
  </script>

</body>
</html>
